<!DOCTYPE html>
<html>
<head>
    <title>Formulário de Upload</title>
</head>
<body>
    <h2>Envie seus dados30</h2>
    <form id="myForm">
        <label for="name">Nome:</label><br>
        <input type="text" id="name" name="name" required><br><br>
        
        <label for="email">Email:</label><br>
        <input type="email" id="email" name="email" required><br><br>
        
        <label for="file">Anexo (PDF/Imagem):</label><br>
        <input type="file" id="file" name="file" accept=".pdf,.png,.jpg,.jpeg" required><br><br>
        
        <input type="submit" value="Enviar">
    </form>

    <!-- Área de debug -->
    <h3>Dados Capturados:</h3>
    <pre id="debug"></pre>

    <script>
document.getElementById('myForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this); // Captura todos os campos automaticamente

    // Debug visual
    const debugContent = `
        Enviando dados...
        Nome: ${this.name.value}
        Email: ${this.email.value}
        Arquivo: ${this.file.files[0].name}
    `;
    document.getElementById('debug').textContent = debugContent;

    fetch('https://script.google.com/macros/s/AKfycbxG5KOfFsF1KJdNfsRDoGKcHSN95D8b-5WU0hq6GhxPzzc1NOXtwjofLwQ2a6VNcvsumQ/exec', {
        method: 'POST',
        body: formData,
        // NÃO adicione headers manualmente
    })
    .then(response => response.text())
    .then(message => {
        document.getElementById('debug').textContent += `\n\nResposta: ${message}`;
    })
    .catch(error => {
        document.getElementById('debug').textContent += `\n\nERRO: ${error.message}`;
    });
});
</script>
</body>
</html>
